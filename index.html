<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>

        class Perso {
            constructor(name, thaco, pv, ca) {
                this.name = name;
                this.thaco = thaco;
                this.pv = pv;
                this.ca = ca;
            }

            getInfos() {
                return `===${this.name}===
                        \n${this.thaco} de thaco
                        \n${this.pv} PV
                        \n${this.ca} de CA
                        .`;
            }

            lowerPV() {
                this.pv = this.pv - throwDice(dice);
                return this.pv;
            }
        }

        class Dice {
            constructor(dice) {
                this.dice = dice;
            }

            throwDice(dice) {
                return Math.floor(Math.random() * dice) + 1;
            }
        }

        class Round {
            constructor(character1, character2) {
                this.character1 = character1;
                this.character2 = character2;
                this.dice = dice;
            }

            rollInit() {
                return this.dice.throwDice(10);
            }

            rollThaco() {
                return this.dice.throwDice(20);
            }

            rollDamage() {
                return this.dice.throwDice(8);
            }

            rollRound() {
                const initiativeCh1 = this.rollInit();
                const initiativeCh2 = this.rollInit();
                const thacoRollCh1 = this.rollThaco();
                const thacoRollCh2 = this.rollThaco();
                const rollDamageCh1 = this.rollDamage();
                const rollDamageCh2 = this.rollDamage();
                const hitsOpponentCh1 = thacoRollCh1 >= this.character1.thaco - this.character2.ca ? true : false;
                const hitsOpponentCh2 = thacoRollCh2 >= this.character2.thaco - this.character1.ca ? true : false;

                const objectCh1 = {
                    basicData: this.character1,
                    roundData: {
                        initiative: initiativeCh1,
                        thacoRoll: thacoRollCh1,
                        damageRoll: rollDamageCh1,
                        hitsOpponent: hitsOpponentCh1
                    }
                }

                const objectCh2 = {
                    basicData: this.character2,
                    roundData: {
                        initiative: initiativeCh2,
                        thacoRoll: thacoRollCh2,
                        damageRoll: rollDamageCh2,
                        hitsOpponent: hitsOpponentCh2
                    }
                }
                
                return {
                    objectCh1,
                    objectCh2
                };
            }

            getInitiativeOutcome() {
                const roundInfo = this.rollRound();

                const ch1 = roundInfo.objectCh1;
                const ch2 = roundInfo.objectCh2;

                if (ch1.roundData.initiative < ch2.roundData.initiative) {
                    return ch1.basicData.name;
                } else if (ch1.roundData.initiative > ch2.roundData.initiative) {
                    return ch2.basicData.name;
                } else {
                    return "En mÃªme temps!";
                }

            }

            playRound() {
                const roundInfo = this.rollRound();

                const ch1 = roundInfo.objectCh1;
                const ch2 = roundInfo.objectCh2;


            }
        }



        // 1. define the dice since the other classes use this big time
        let dice = new Dice();

        // 2. define the characters - 1. name 2. thaco 3. HP 4. AC
        let bordur = new Perso("Bordur", 20, dice.throwDice(10), 10);
        let orc = new Perso("orc", 20, dice.throwDice(8), 10);

        // 3. define a round
        let round = new Round(bordur, orc);



        console.log(round.rollRound());
        console.log(round.getInitiativeOutcome());

    </script>
</body>
</html>